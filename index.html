<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Rails-dev-box-runs-oracle by yahonda</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Rails-dev-box-runs-oracle</h1>
          <h2>A virtual machine for Ruby on Rails core development</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/yahonda/rails-dev-box-runs-oracle/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/yahonda/rails-dev-box-runs-oracle/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/yahonda/rails-dev-box-runs-oracle" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a name="a-virtual-machine-for-ruby-on-rails-core-development-with-oracle-database" class="anchor" href="#a-virtual-machine-for-ruby-on-rails-core-development-with-oracle-database"><span class="octicon octicon-link"></span></a>A Virtual Machine for Ruby on Rails Core Development with Oracle Database</h1>

<h2>
<a name="introduction" class="anchor" href="#introduction"><span class="octicon octicon-link"></span></a>Introduction</h2>

<p>This project provides Oracle Database support on top of rails-dev-box. </p>

<h2>
<a name="requirements" class="anchor" href="#requirements"><span class="octicon octicon-link"></span></a>Requirements</h2>

<ul>
<li><p><a href="https://www.virtualbox.org">VirtualBox</a></p></li>
<li><p><a href="http://vagrantup.com">Vagrant 1.1+</a></p></li>
<li><p>VirtualBox needs support for 64-bit guests</p></li>
</ul><h2>
<a name="how-to-build-the-virtual-machine" class="anchor" href="#how-to-build-the-virtual-machine"><span class="octicon octicon-link"></span></a>How To Build The Virtual Machine</h2>

<p>Building the virtual machine is this easy:</p>

<ul>
<li>Download <a href="http://www.oracle.com/technetwork/products/express-edition/overview/index.html">Oracle Database 11g Express Edition</a> for Linux x64. The file name is <code>oracle-xe-11.2.0-1.0.x86_64.rpm.zip</code>.</li>
</ul><div class="highlight"><pre>    host <span class="nv">$ </span>git clone https://github.com/yahonda/rails-dev-box-runs-oracle.git
    host <span class="nv">$ </span>cp oracle-xe-11.2.0-1.0.x86_64.rpm.zip rails-dev-box-runs-oracle/puppet/modules/oracle/files/.
    host <span class="nv">$ </span><span class="nb">cd </span>rails-dev-box-runs-oracle
    host <span class="nv">$ </span>vagrant up
</pre></div>

<p>That's it.</p>

<p>After the installation has finished, you can access the virtual machine with:</p>

<div class="highlight"><pre>    host <span class="nv">$ </span>vagrant ssh
    Welcome to Ubuntu 12.04 LTS <span class="o">(</span>GNU/Linux 3.2.0-23-generic x86_64<span class="o">)</span>
    ...
    vagrant@rails-dev-box:~<span class="nv">$ </span>sqlplus system/manager@localhost/XE
</pre></div>

<p>Port 3000 in the host computer is forwarded to port 3000 in the virtual machine. Thus, applications running in the virtual machine can be accessed via localhost:3000 in the host computer. </p>

<p>Similarly, Oracle's default network listener port 1521 in the host computer is forwarded to port 1521 in the virtual machine. Oracle tools in the host computer can connect to the database in the virtual machine:</p>

<div class="highlight"><pre>    host <span class="nv">$ </span>sqlplus system/manager@localhost/XE
</pre></div>

<h2>
<a name="whats-in-the-box" class="anchor" href="#whats-in-the-box"><span class="octicon octicon-link"></span></a>What's In The Box</h2>

<ul>
<li><p>Everthing in <a href="https://github.com/rails/rails-dev-box">rails-dev-box</a></p></li>
<li><p>Oracle Database 11g Express Edition</p></li>
</ul><h2>
<a name="how-to-clone-rails-repositories-and-execute-unit-tests" class="anchor" href="#how-to-clone-rails-repositories-and-execute-unit-tests"><span class="octicon octicon-link"></span></a>How to clone Rails repositories and execute unit tests</h2>

<p>Just clone your Rails fork in the very directory of the Rails development box in the host computer:</p>

<pre><code>host $ ls
README.md   Vagrantfile puppet
host $ git clone -b 3-2-stable https://github.com/rails/rails.git rails
</code></pre>

<p>Vagrant mounts that very directory as <em>/vagrant</em> within the virtual machine:</p>

<pre><code>vagrant@rails-dev-box:~$ ls /vagrant
puppet  rails  README.md  Vagrantfile
</code></pre>

<h2>
<a name="execute-activerecord-32-unit-tests-with-oracle-enhanced-adapter" class="anchor" href="#execute-activerecord-32-unit-tests-with-oracle-enhanced-adapter"><span class="octicon octicon-link"></span></a>Execute ActiveRecord 3.2 unit tests with Oracle enhanced adapter</h2>

<p>Just execute as described steps below. </p>

<pre><code>vagrant@rails-dev-box:~$ cd /vagrant/rails/activerecord
vagrant@rails-dev-box:/vagrant/rails/activerecord$ bundle
vagrant@rails-dev-box:/vagrant/rails/activerecord$ rake test_oracle
</code></pre>

<h2>
<a name="how-to-clone-the-oracle-enhancedd-repository-and-execute-unit-tests" class="anchor" href="#how-to-clone-the-oracle-enhancedd-repository-and-execute-unit-tests"><span class="octicon octicon-link"></span></a>How to clone the Oracle enhancedd repository and execute unit tests</h2>

<p>Clone the oracle-enhanced repository as you do Rails.</p>

<pre><code>host $ ls
README.md   Vagrantfile puppet rails

host $ git clone -b gemfile_master https://github.com/yahonda/oracle-enhanced.git oracle-enhanced

host $ ls
oracle-enhanced README.md   Vagrantfile puppet rails
</code></pre>

<h2>
<a name="execute-oracle-enhanced-adapter-unit-tests-with-rails-32x" class="anchor" href="#execute-oracle-enhanced-adapter-unit-tests-with-rails-32x"><span class="octicon octicon-link"></span></a>Execute Oracle enhanced adapter unit tests with Rails 3.2.x</h2>

<p>Just execute as described steps below. </p>

<pre><code>vagrant@rails-dev-box:~$ cd /vagrant/oracle-enhanced
vagrant@rails-dev-box:/vagrant/oracle-enhanced $ export RAILS_GEM_PATH=/vagrant/rails
vagrant@rails-dev-box:/vagrant/oracle-enhanced$ bundle
vagrant@rails-dev-box:/vagrant/oracle-enhanced$ rspec
</code></pre>

<h2>
<a name="how-about-rails-40" class="anchor" href="#how-about-rails-40"><span class="octicon octicon-link"></span></a>How about Rails 4.0?</h2>

<p>As of right now Testing Rails 4.0.x and newer version of rails is not straightforward and needs a lot of help. This is the reason why rails-dev-box-runs-oracle is there. Will update these steps soon.</p>

<h2>
<a name="notes" class="anchor" href="#notes"><span class="octicon octicon-link"></span></a>Notes</h2>

<p>If your host is behind a firewall and 'vagrant up' gets errors running apt-get or installing RVM, then create ~/.vagrant.d/Vagrantfile to update the virtual machine's proxy settings:</p>

<div class="highlight"><pre>    <span class="c"># ~/.vagrant.d/Vagrantfile</span>
    Vagrant.configure<span class="o">(</span><span class="s1">'2'</span><span class="o">)</span> <span class="k">do</span> |config|
      config.vm.provision :shell, :inline <span class="o">=</span>&gt; <span class="s2">"echo 'Acquire::http::proxy \"http://proxy.example.com:80/\";' &gt;&gt; /etc/apt/apt.conf"</span>
      config.vm.provision :shell, :inline <span class="o">=</span>&gt; <span class="s2">"echo 'Acquire::https::proxy \"http://proxy.example.com:80/\";' &gt;&gt; /etc/apt/apt.conf"</span>
      config.vm.provision :shell, :inline <span class="o">=</span>&gt; <span class="s2">"echo 'export http_proxy=http://proxy.example.com:80/' &gt; /etc/profile.d/vagrant_proxy.sh"</span>
      config.vm.provision :shell, :inline <span class="o">=</span>&gt; <span class="s2">"echo 'export https_proxy=http://proxy.example.com:80/' &gt;&gt; /etc/profile.d/vagrant_proxy.sh"</span>
    end
</pre></div>

<p>Change the proxy name and port to be your network's proxy.</p>

<h2>
<a name="acknowledgements" class="anchor" href="#acknowledgements"><span class="octicon octicon-link"></span></a>Acknowledgements</h2>

<p>This project is based on <a href="https://github.com/rails/rails-dev-box">rails-dev-box</a> 
and <a href="https://github.com/hilverd/vagrant-ubuntu-oracle-xe">vagrant-ubuntu-oracle-xe</a>.</p>

<p>Thanks to everyone who contributes to these projects.</p>

<h2>
<a name="questions" class="anchor" href="#questions"><span class="octicon octicon-link"></span></a>Questions</h2>

<p>Please email me <a href="mailto:yasuo.honda@gmail.com">yasuo.honda@gmail.com</a></p>
        </section>

        <footer>
          Rails-dev-box-runs-oracle is maintained by <a href="https://github.com/yahonda">yahonda</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>